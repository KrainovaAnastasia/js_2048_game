const t=new class{constructor(t){this.state=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}updateUI(){document.querySelectorAll(".field-cell").forEach((t,e)=>{let s=Math.floor(e/4),a=this.state[s][e%4];t.className="field-cell",a>0?(t.classList.add(`field-cell--${a}`),t.textContent=a):t.textContent=""}),document.querySelector(".game-score").textContent=this.score}addRandomTile(){let t=[];if(this.state.forEach((e,s)=>{e.forEach((e,a)=>{0===e&&t.push({row:s,col:a})})}),t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:a}=t[e],i=.9>Math.random()?2:4;this.state[s][a]=i}}moveRight(){let t=!1;for(let e=0;e<4;e++){let s=this.state[e].filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.unshift(0);a.toString()!==this.state[e].toString()&&(this.state[e]=a,t=!0)}t&&(this.addRandomTile(),this.updateUI())}moveLeft(){let t=!1;for(let e=0;e<4;e++){let s=this.state[e].filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);a.toString()!==this.state[e].toString()&&(this.state[e]=a,t=!0)}t&&(this.addRandomTile(),this.updateUI())}moveUp(){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.state[s][e]!==a[s]&&(this.state[s][e]=a[s],t=!0)}t&&(this.addRandomTile(),this.updateUI())}moveDown(){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=3;t>=0;t--)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.state[3-s][e]!==a[s]&&(this.state[3-s][e]=a[s],t=!0)}t&&(this.addRandomTile(),this.updateUI())}getScore(){}getState(){}getStatus(){let t=!1,e=!1;for(let s=0;s<4;s++)for(let a=0;a<4;a++){if(2048===this.state[s][a])return this.status="win","win";0===this.state[s][a]&&(t=!0),(s<3&&this.state[s][a]===this.state[s+1][a]||a<3&&this.state[s][a]===this.state[s][a+1])&&(e=!0)}return t||e?(this.status="playing","playing"):(this.status="lose","lose")}start(){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateUI()}restart(){this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateUI(),this.getStatus()}},e=document.getElementById("start-button"),s=document.querySelector(".message-start"),a=document.querySelector(".message-win"),i=document.querySelector(".message-lose");function l(t){"win"===t?(a.classList.remove("hidden"),i.classList.add("hidden")):"lose"===t?(i.classList.remove("hidden"),a.classList.add("hidden"),e.textContent="Restart",e.classList.add("restart"),e.classList.remove("start")):(a.classList.add("hidden"),i.classList.add("hidden"))}e.addEventListener("click",()=>{"Start"===e.textContent?(s.classList.add("hidden"),t.start(),e.textContent="Restart"):(t.restart(),s.classList.add("hidden"),l("playing"))}),document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}let s=document.querySelectorAll(".field-cell");s.forEach(t=>{t.classList.add("moving")}),t.updateUI(),l(t.getStatus()),setTimeout(()=>{s.forEach(t=>{t.classList.remove("moving")})},300)});
//# sourceMappingURL=index.6362b80e.js.map
